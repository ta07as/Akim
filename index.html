<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Talas_master Ultimate AI Studio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        
        :root {
            --brand-gold: #FBBF24;
            --brand-black: #000000;
            --brand-zinc: #18181b;
        }

        body {
            background-color: var(--brand-black);
            color: #ffffff;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
        }

        .gold-border { border: 1px solid rgba(251, 191, 36, 0.3); }
        .gold-bg { background-color: var(--brand-gold); }
        .gold-text { color: var(--brand-gold); }
        
        .glass-card {
            background: rgba(24, 24, 27, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .input-focus:focus {
            border-color: var(--brand-gold);
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.2);
        }

        .active-category {
            background-color: var(--brand-gold) !important;
            color: #000 !important;
            font-weight: 900;
            transform: translateY(-2px);
        }

        .btn-animate {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-content { animation: slideUp 0.6s ease-out forwards; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--brand-gold); }
    </style>
</head>
<body class="min-h-screen selection:bg-yellow-400 selection:text-black">

    <!-- Top Navigation -->
    <nav class="border-b border-zinc-800/50 bg-black/50 backdrop-blur-md sticky top-0 z-[100]">
        <div class="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 gold-bg rounded-lg flex items-center justify-center text-black shadow-lg shadow-yellow-500/20">
                    <i class="fas fa-microchip text-xl"></i>
                </div>
                <div>
                    <span class="block text-xl font-black tracking-tighter uppercase italic">TALAS<span class="gold-text">_MASTER</span></span>
                    <span class="block text-[8px] uppercase tracking-[0.3em] text-zinc-500 font-bold leading-none">Creative Intelligence</span>
                </div>
            </div>
            <div class="hidden md:flex items-center gap-8">
                <div class="text-right">
                    <p class="text-[9px] text-zinc-500 uppercase font-black tracking-widest">Support Line</p>
                    <a href="https://wa.me/996755000228" class="text-sm font-black hover:gold-text transition-colors">+996 755 000 228</a>
                </div>
                <div class="h-10 w-px bg-zinc-800"></div>
                <button class="bg-white/5 hover:bg-white/10 p-2 rounded-full px-5 text-[10px] font-bold uppercase tracking-tighter transition-all">
                    System Active
                </button>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-6 py-12 grid grid-cols-1 lg:grid-cols-12 gap-10">
        
        <!-- Sidebar Controls -->
        <div class="lg:col-span-4 space-y-8">
            <div class="glass-card p-8 rounded-[2rem] gold-border relative overflow-hidden">
                <div class="absolute top-0 right-0 p-4 opacity-5">
                    <i class="fas fa-video text-8xl -rotate-12"></i>
                </div>

                <h2 class="text-sm font-black uppercase mb-8 gold-text flex items-center gap-3">
                    <i class="fas fa-terminal"></i> Параметры Контента
                </h2>

                <!-- Category Engine -->
                <div class="mb-8">
                    <label class="text-[10px] uppercase font-bold text-zinc-400 mb-4 block">Направление проекта</label>
                    <div class="grid grid-cols-2 gap-2" id="catGroup">
                        <button onclick="updateCat('Профи', this)" class="btn-animate p-3 bg-zinc-900/50 rounded-xl text-[10px] font-bold uppercase border border-zinc-800 active-category">Профи</button>
                        <button onclick="updateCat('Бизнес', this)" class="btn-animate p-3 bg-zinc-900/50 rounded-xl text-[10px] font-bold uppercase border border-zinc-800">Бизнес</button>
                        <button onclick="updateCat('Блогинг', this)" class="btn-animate p-3 bg-zinc-900/50 rounded-xl text-[10px] font-bold uppercase border border-zinc-800">Блогинг</button>
                        <button onclick="updateCat('Другое', this)" class="btn-animate p-3 bg-zinc-900/50 rounded-xl text-[10px] font-bold uppercase border border-zinc-800">Другое</button>
                    </div>
                    <input type="text" id="manualCat" placeholder="Укажите сферу (напр. Бухгалтерия)" 
                           class="hidden w-full mt-3 bg-black border border-zinc-800 rounded-xl p-4 text-xs outline-none focus:border-yellow-500 transition-all">
                </div>

                <!-- Input Engine -->
                <div class="space-y-6">
                    <div>
                        <label class="text-[10px] uppercase font-bold text-zinc-400 mb-2 block">Опишите суть видео</label>
                        <textarea id="promptIn" placeholder="Например: Как правильно выбрать материалы или обзор рабочего дня..." 
                                  class="w-full bg-black/50 border border-zinc-800 rounded-2xl p-5 text-sm input-focus outline-none h-40 transition-all resize-none"></textarea>
                    </div>

                    <div>
                        <label class="text-[10px] uppercase font-bold text-zinc-400 mb-2 block">Хронометраж</label>
                        <select id="timeIn" class="w-full bg-black/50 border border-zinc-800 rounded-xl p-4 text-xs input-focus outline-none appearance-none">
                            <option value="15-20 сек">Shorts / Reels (Динамика)</option>
                            <option value="30-45 сек" selected>Стандарт (Оптимально)</option>
                            <option value="60 сек">Long-form (Экспертно)</option>
                        </select>
                    </div>

                    <button id="genBtn" onclick="runGeneration()" class="w-full gold-bg text-black py-5 rounded-2xl font-black uppercase text-xs tracking-widest hover:scale-[1.02] active:scale-95 transition-all shadow-xl shadow-yellow-500/10">
                        <i class="fas fa-wand-sparkles mr-2"></i> Сгенерировать Сценарий
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Workspace -->
        <div class="lg:col-span-8">
            <div id="canvas" class="glass-card rounded-[2.5rem] min-h-[700px] flex flex-col relative overflow-hidden">
                
                <!-- Loading State -->
                <div id="loading" class="hidden absolute inset-0 z-50 bg-black/90 backdrop-blur-xl flex flex-col items-center justify-center">
                    <div class="relative w-24 h-24 mb-8">
                        <div class="absolute inset-0 border-2 border-zinc-800 rounded-full"></div>
                        <div class="absolute inset-0 border-t-2 border-yellow-500 rounded-full animate-spin"></div>
                        <i class="fas fa-brain absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-2xl gold-text"></i>
                    </div>
                    <div class="text-center">
                        <h3 class="text-xl font-black uppercase italic tracking-tighter mb-2">Процесс запущен</h3>
                        <p class="text-[10px] text-zinc-500 uppercase font-bold tracking-[0.3em]">Нейросеть проектирует ваш контент</p>
                    </div>
                </div>

                <!-- Empty State -->
                <div id="empty" class="flex-1 flex flex-col items-center justify-center p-20 text-center opacity-20">
                    <i class="fas fa-rocket text-9xl mb-10"></i>
                    <h2 class="text-2xl font-black uppercase italic">Готов к работе</h2>
                    <p class="text-xs max-w-xs mt-4 font-medium uppercase tracking-widest leading-loose">Заполните данные слева для создания профессионального медиа-плана</p>
                </div>

                <!-- Result View -->
                <div id="content" class="hidden p-10 flex-1 overflow-y-auto">
                    <!-- Data Injected Here -->
                </div>
            </div>
        </div>
    </main>

    <!-- Global Notifications -->
    <div id="toast" class="fixed bottom-10 left-1/2 -translate-x-1/2 bg-white text-black px-8 py-4 rounded-full font-black text-[10px] uppercase shadow-2xl opacity-0 translate-y-10 transition-all z-[100]">
        Notification
    </div>

    <script>
        const apiKey = "";
        let activeCat = "Профи";

        function updateCat(val, el) {
            activeCat = val;
            document.querySelectorAll('#catGroup button').forEach(b => b.classList.remove('active-category'));
            el.classList.add('active-category');
            
            const manual = document.getElementById('manualCat');
            if (val === 'Другое') {
                manual.classList.remove('hidden');
                manual.focus();
            } else {
                manual.classList.add('hidden');
            }
        }

        async function fetchWithRetry(url, options, retries = 5) {
            let delay = 1000;
            for (let i = 0; i < retries; i++) {
                try {
                    const res = await fetch(url, options);
                    if (res.ok) return res;
                    if (res.status === 429 || res.status >= 500) {
                        await new Promise(r => setTimeout(r, delay));
                        delay *= 2; continue;
                    }
                    return res;
                } catch (e) {
                    if (i === retries - 1) throw e;
                    await new Promise(r => setTimeout(r, delay));
                    delay *= 2;
                }
            }
        }

        async function runGeneration() {
            const prompt = document.getElementById('promptIn').value;
            const timing = document.getElementById('timeIn').value;
            const manual = document.getElementById('manualCat').value;
            
            const sector = activeCat === 'Другое' ? (manual || 'Общий контент') : activeCat;

            if (!prompt) return showToast('Опишите идею ролика');

            toggleLoader(true);

            const systemTask = `Ты - AI Продюсер Talas_master. 
            Создай 1 безупречный сценарий для видео (Reels/Shorts). 
            Ниша: ${sector}. Тема: ${prompt}. Длительность: ${timing}.
            
            Твоя задача - сделать вовлекающий сценарий, который продает экспертность.
            Обязательный призыв к действию в конце: "Свяжитесь с Talas_master: +996 755 000 228".
            
            ОТВЕТЬ СТРОГО В JSON:
            {
                "title": "Хайповый заголовок",
                "concept": "Главная цель ролика",
                "shots": "Пошаговый план съемок (что должно быть в кадре)",
                "voiceover": "Текст для озвучки (Хук, Тело, CTA)",
                "pro_tip": "Профессиональный совет по монтажу"
            }`;

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

            try {
                const response = await fetchWithRetry(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: `Создай сценарий для ${sector} по теме: ${prompt}` }] }],
                        systemInstruction: { parts: [{ text: systemTask }] },
                        generationConfig: { responseMimeType: "application/json" }
                    })
                });

                if (!response.ok) throw new Error(`Status: ${response.status}`);

                const raw = await response.json();
                const content = JSON.parse(raw.candidates[0].content.parts[0].text);
                
                renderResult(content);
                showToast('СЦЕНАРИЙ СОЗДАН');
            } catch (err) {
                console.error(err);
                showToast('ОШИБКА СИСТЕМЫ - ПОПРОБУЙТЕ СНОВА');
            } finally {
                toggleLoader(false);
            }
        }

        function renderResult(data) {
            const container = document.getElementById('content');
            const empty = document.getElementById('empty');
            
            empty.style.display = 'none';
            container.style.display = 'block';
            
            container.innerHTML = `
                <div class="animate-content">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-10 border-b border-zinc-800 pb-8">
                        <div>
                            <h3 class="text-4xl font-black italic uppercase tracking-tighter">${data.title}</h3>
                            <p class="text-zinc-500 text-[10px] uppercase font-bold tracking-[0.2em] mt-2">Концепция: ${data.concept}</p>
                        </div>
                        <button onclick="copyFull('${data.title}', '${data.voiceover}')" class="bg-white text-black px-6 py-3 rounded-xl font-black text-[10px] uppercase hover:bg-yellow-500 transition-all shadow-lg">
                            <i class="fas fa-copy mr-2"></i> Копировать сценарий
                        </button>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="space-y-6">
                            <div class="bg-zinc-900/40 p-8 rounded-[2rem] border border-zinc-800">
                                <label class="text-[9px] font-black gold-text uppercase mb-4 block tracking-widest italic">План кадров (Visuals)</label>
                                <p class="text-[12px] leading-relaxed text-zinc-300 font-medium">${data.shots}</p>
                            </div>
                            <div class="bg-yellow-500/5 p-6 rounded-2xl border border-yellow-500/10">
                                <p class="text-[8px] font-black gold-text uppercase mb-2">Совет от Talas_master</p>
                                <p class="text-[11px] italic text-zinc-400">${data.pro_tip}</p>
                            </div>
                        </div>

                        <div class="bg-zinc-900/60 p-8 rounded-[2rem] border border-yellow-500/20 shadow-2xl">
                            <label class="text-[9px] font-black gold-text uppercase mb-4 block tracking-widest italic">Дикторский текст (Script)</label>
                            <div class="text-[13px] leading-loose text-zinc-100 whitespace-pre-line font-medium">${data.voiceover}</div>
                        </div>
                    </div>

                    <div class="mt-10 p-5 bg-zinc-900/20 rounded-2xl border border-zinc-800/50 flex items-center justify-center gap-4">
                        <span class="text-[9px] text-zinc-600 font-black uppercase">Система готова к новому запросу</span>
                        <div class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></div>
                    </div>
                </div>
            `;
            container.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function toggleLoader(s) {
            document.getElementById('loading').classList.toggle('hidden', !s);
        }

        function showToast(m) {
            const t = document.getElementById('toast');
            t.innerText = m;
            t.classList.remove('opacity-0', 'translate-y-10');
            setTimeout(() => t.classList.add('opacity-0', 'translate-y-10'), 3000);
        }

        function copyFull(t, s) {
            const txt = `ТЕМА: ${t}\n\nСЦЕНАРИЙ:\n${s}`;
            const el = document.createElement('textarea');
            el.value = txt;
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
            showToast('СКОПИРОВАНО');
        }
    </script>
</body>
</html>
